<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="naz-hage" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Module - Ntools - Work in Progress</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Module";
        var mkdocs_page_input_path = "ntools/ntools-scripts-module.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> Ntools - Work in Progress
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Getting Started</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../..">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../installation/">Installation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../usage/">Practice</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../setup/">Setup your project</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../buildtypes/">Build Types</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../versioning/">Versioning</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">List of Tools</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../nbuild/">Nbuild (nb.exe)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../lf/">lf (lf.exe)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../nbackup/">Nbackup (nbackup.exe)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../wi/">wi (wi.exe)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../github-release/">Github Release</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Custom Build Tasks</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../nbuildtasks/">Nbuild Tasks</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Developer setup</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../../version-automation-guide/">Version Automation Guide</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ntools/">Development Tools</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" >ntools-scripts module</a>
    <ul class="current">
                <li class="toctree-l2 current"><a class="reference internal current" href="#">Module</a>
    <ul class="current">
    <li class="toctree-l3"><a class="reference internal" href="#quick-start">Quick start</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#table-of-contents">Table of contents</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#overview">Overview</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#manual-installation">Manual Installation</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module-information">Module Information</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#architecture">Architecture</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#before-individual-scripts">Before (Individual Scripts)</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#usage-examples">Usage Examples</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#get-module-information">Get Module Information</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#install-ntools-with-custom-configuration">Install NTools with Custom Configuration</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#publish-projects-with-deterministic-path">Publish Projects with Deterministic Path</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#run-tests-and-coverage">Run Tests and Coverage</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#integration-with-build-system">Integration with Build System</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#artifact-verification-msbuild">Artifact Verification (MSBuild)</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#msbuild-integration">MSBuild Integration</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#smoke_test-target-integration">SMOKE_TEST Target Integration</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#github-actions-integration">GitHub Actions Integration</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#key-improvements">Key Improvements</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#1-deterministic-repository-path-detection">1. Deterministic Repository Path Detection</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#2-configurable-ntoolsjson-path">2. Configurable ntools.json Path</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#3-unified-error-handling">3. Unified Error Handling</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#4-backward-compatibility">4. Backward Compatibility</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#migration-from-legacy-scripts">Migration from Legacy Scripts</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#for-developers">For Developers</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#for-cicd">For CI/CD</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#for-msbuild">For MSBuild</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#module-development">Module Development</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#adding-new-functions">Adding New Functions</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#testing">Testing</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#installation">Installation</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#best-practices">Best Practices</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#troubleshooting">Troubleshooting</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#module-not-found">Module Not Found</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#version-issues">Version Issues</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#function-not-available">Function Not Available</a>
    </li>
        </ul>
    </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../ntools-scripts-module-api/">API</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Build System Features</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../code-coverage/">Code Coverage</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../nbuild-targets/">MSBuild Targets</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">Ntools - Work in Progress</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Developer setup</li>
          <li class="breadcrumb-item">ntools-scripts module</li>
      <li class="breadcrumb-item active">Module</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/naz-hage/ntools/edit/main/docs/ntools/ntools-scripts-module.md">Edit on ntools</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="ntools-scripts-powershell-module">ntools-scripts PowerShell Module</h1>
<p>This page documents the <code>ntools-scripts</code> PowerShell module and serves as the canonical API reference for the module's exported functions and usage.</p>
<p><strong>Location</strong>: <code>scripts/module-package/ntools-scripts.psm1</code></p>
<h2 id="quick-start">Quick start</h2>
<p>Follow these minimal steps to start using the module locally or in CI.</p>
<pre><code class="language-powershell"># Import for local development
Import-Module &quot;./scripts/module-package/ntools-scripts.psm1&quot; -Force

# Check the module version
Get-NtoolsScriptsVersion

# Install NTools using a local configuration file
Install-NTools -NtoolsJsonPath &quot;./dev-setup/ntools.json&quot;
</code></pre>
<h2 id="table-of-contents">Table of contents</h2>
<ul>
<li>Quick start</li>
<li>Overview</li>
<li>Import the Module</li>
<li>Usage examples</li>
<li>Module information</li>
<li>Architecture &amp; migration</li>
<li>Module development</li>
<li>Troubleshooting</li>
<li>Canonical API reference</li>
</ul>
<h2 id="overview">Overview</h2>
<p>Module files:</p>
<pre><code>scripts/
## Available functions (summary)

The module exports a broad set of functions covering build, CI/devops, setup/install, testing, utilities, and code-signing helpers. For the complete, authoritative list of exported function names and the exact API surface, see the dedicated API reference:

- docs/ntools/ntools-scripts-module-api.md

If you need to discover functions at runtime, import the module and run:

```powershell
Get-Command -Module ntools-scripts | Sort-Object Name
</code></pre>
<pre><code class="language-powershell"># Test the module
Import-Module &quot;./scripts/module-package/ntools-scripts.psm1&quot; -Force
Test-NToolsScriptsModule
</code></pre>
<h2 id="manual-installation">Manual Installation</h2>
<pre><code class="language-powershell"># Install module manually for development
Install-NToolsScriptsModule -InstallPath &quot;$env:ProgramFiles\WindowsPowerShell\Modules\ntools-scripts&quot; -Force
</code></pre>
<p>The ntools-scripts module is a comprehensive PowerShell module that consolidates all NTools PowerShell functionality into a single, reusable module. This module replaces the previous collection of individual scripts with a structured, function-based approach.</p>
<h2 id="module-information">Module Information</h2>
<p><strong>Version</strong>: 2.3.0<br />
<strong>Location</strong>: <code>scripts/module-package/ntools-scripts.psm1</code><br />
<strong>Installation</strong>: Automatically installed via MSBuild targets and GitHub Actions</p>
<h2 id="architecture">Architecture</h2>
<p>The module consolidates functionality from the previous script structure:</p>
<h3 id="before-individual-scripts">Before (Individual Scripts)</h3>
<pre><code>scripts/
├── build/build-verify-artifacts.ps1   # deprecated - functionality moved to Invoke-VerifyArtifacts
├── devops/ (legacy scripts migrated into module)

Use the `Set-DevelopmentEnvironment` function in the `ntools-scripts` module instead. It provides the same behavior (sets user `devDrive` and `mainDir` environment variables) and is callable directly from PowerShell or via MSBuild using the `SETUP_ENVIRONMENT` target in `nbuild.targets`.

Example (PowerShell):

```powershell
Import-Module &quot;./scripts/module-package/ntools-scripts.psm1&quot; -Force
Set-DevelopmentEnvironment -DevDrive 'D:' -MainDir 'source'
</code></pre>
<p>MSBuild (from repo root):</p>
<pre><code class="language-powershell">msbuild /t:SETUP_ENVIRONMENT /p:DevDrive=D: /p:MainDir=source
</code></pre>
<p>├── test/  # Legacy test scripts were consolidated into the <code>ntools-scripts</code> module
└── ... (legacy scripts removed; use module functions)</p>
<pre><code>
### After (Consolidated Module)
</code></pre>
<p>scripts/
├── module-package/
│   ├── ntools-scripts.psm1     # Main module with all functions
│   ├── ntools-scripts.psd1     # Module manifest
│   └── install-module.ps1      # Installation script
├── build/                      # Legacy scripts (deprecated)
├── devops/                     # Legacy scripts (deprecated)
├── setup/                      # Entry point scripts
└── test/                       # Legacy scripts (deprecated)</p>
<pre><code>
## Available Functions

The module exports 36 functions organized by category:

### Build Functions
-- `Publish-AllProjects` - Build and publish all non-test projects with deterministic repository path
-- `Invoke-VerifyArtifacts` - Comprehensive artifact verification
- `Get-ProjectFiles` - Get project files with filtering
- `Invoke-ProjectPublish` - Publish individual projects

### DevOps Functions  
- `Get-AgentPublicIp` - Get public IP for Azure DevOps agents and set pipeline variable
- `Add-WafAllowRule` - Add Azure WAF allow rule for an IP
- `Remove-WafCustomRule` - Remove Azure WAF custom rule
- `Get-VersionFromJson` - Extract version information from JSON files
- `Update-DocVersions` - Update version tables in markdown documentation

### Setup Functions
- `Set-DevelopmentEnvironment` - Set up development environment
- `Install-DevelopmentApps` - Install development applications
- `Install-NTools` - Install NTools from releases (with configurable ntools.json path)
- `Install-NToolsScriptsModule` - Install this module

### Test Functions
- `Invoke-CodeCoverage` - Run tests with code coverage
- `Test-MSBuildDelegation` - Test MSBuild target delegation (**Note**: Now automatically integrated into `nb smoke_test` target)
- `Test-QuickTargets` - Quick target validation
- `Test-NToolsScriptsModule` - Test module functionality
- `Write-TestResult` - Write formatted test results
- `Test-TargetExists` - Check if MSBuild targets exist
- `Test-TargetDependencies` - Validate target dependencies
- `Test-TargetDelegation` - Test target delegation patterns (**Note**: Core function used by `nb smoke_test` target)

### Utility Functions
- `Get-FileHash256` - Calculate SHA256 hash of files
- `Get-FileVersionInfo` - Get file version information
- `Invoke-FastForward` - Git fast-forward operations
- `Write-OutputMessage` - Standardized output messaging
- `Get-NToolsFileVersion` - Get NTools file version information
- `Add-DeploymentPathToEnvironment` - Add paths to PATH environment variable
- `Invoke-NToolsDownload` - Download NTools packages

### Common Functions
- `Write-Info` - Write informational messages
- `Write-Success` - Write success messages
- `Write-Warning` - Write warning messages
- `Write-Error` - Write error messages
- `Get-NtoolsScriptsVersion` - Get module version information

## Canonical module API (single source of truth)

The complete, authoritative list of exported functions is available in the separate API reference:

- docs/ntools/ntools-scripts-module-api.md

For quick discovery at runtime, import the module and list commands:

```powershell
Import-Module &quot;./scripts/module-package/ntools-scripts.psm1&quot; -Force
Get-Command -Module ntools-scripts | Select-Object Name
</code></pre>
<h2 id="usage-examples">Usage Examples</h2>
<p>For import instructions, see the "Import the Module" section near the top of this page.</p>
<h3 id="get-module-information">Get Module Information</h3>
<pre><code class="language-powershell"># Get version
Get-NtoolsScriptsVersion

# List all available functions
Get-Command -Module ntools-scripts | Select-Object Name | Format-Table -AutoSize
</code></pre>
<h3 id="install-ntools-with-custom-configuration">Install NTools with Custom Configuration</h3>
<pre><code class="language-powershell"># Install using specific ntools.json file
Install-NTools -NtoolsJsonPath &quot;./dev-setup/ntools.json&quot;

# Install specific version
Install-NTools -Version &quot;1.29.7&quot; -DownloadsDirectory &quot;C:\MyDownloads&quot;
</code></pre>
<h3 id="publish-projects-with-deterministic-path">Publish Projects with Deterministic Path</h3>
<pre><code class="language-powershell"># Publish all projects with explicit repository root
Publish-AllProjects -OutputDir &quot;C:\Artifacts&quot; -Version &quot;1.0.0&quot; -RepositoryRoot &quot;C:\MyRepo&quot;
</code></pre>
<h3 id="run-tests-and-coverage">Run Tests and Coverage</h3>
<pre><code class="language-powershell"># Run code coverage
Invoke-CodeCoverage

# Test MSBuild delegation (also available via 'nb smoke_test')
Test-MSBuildDelegation

# Or use the comprehensive smoke test target
# nb smoke_test  # (from command line - includes both artifact validation AND target delegation)
</code></pre>
<h3 id="integration-with-build-system">Integration with Build System</h3>
<ul>
<li><strong>Installation</strong>: <code>nbuild.targets</code> automatically installs the module during <code>INSTALL_NTOOLS_SCRIPTS</code> target</li>
<li><strong>Usage</strong>: <code>PUBLISH</code> target uses <code>Publish-AllProjects</code> function with deterministic repository path</li>
</ul>
<h3 id="artifact-verification-msbuild">Artifact Verification (MSBuild)</h3>
<p>The module exposes <code>Invoke-VerifyArtifacts</code> which is also wired into MSBuild via the <code>VERIFY_ARTIFACTS</code> target in <code>nbuild.targets</code>.</p>
<p>PowerShell example (local):</p>
<pre><code class="language-powershell">Import-Module &quot;./scripts/module-package/ntools-scripts.psm1&quot; -Force
Invoke-VerifyArtifacts -ArtifactsPath &quot;C:\Artifacts\MySolution\Release\1.2.3&quot; -ProductVersion &quot;1.2.3&quot;
</code></pre>
<p>MSBuild / nb CLI example:</p>
<pre><code class="language-bash"># Run the MSBuild target from the repo root (nb delegates to MSBuild)
nb verify_artifacts /p:ArtifactsFolder=&quot;C:\Artifacts\MySolution\Release\1.2.3&quot; /p:ProductVersion=&quot;1.2.3&quot;
</code></pre>
<h3 id="msbuild-integration">MSBuild Integration</h3>
<ul>
<li><strong>Installation</strong>: <code>nbuild.targets</code> automatically installs the module during <code>INSTALL_NTOOLS_SCRIPTS</code> target</li>
<li><strong>Usage</strong>: <code>PUBLISH</code> target uses <code>Publish-AllProjects</code> function with deterministic repository path</li>
<li><strong>Smoke Testing</strong>: <code>SMOKE_TEST</code> target uses <code>Test-TargetDelegation</code> function for build system validation</li>
<li><strong>Location</strong>: Module installed to <code>$env:ProgramFiles\nbuild\modules\ntools-scripts\</code></li>
</ul>
<h3 id="smoke_test-target-integration">SMOKE_TEST Target Integration</h3>
<p>The comprehensive <code>SMOKE_TEST</code> target combines artifact validation with PowerShell module functions:</p>
<pre><code class="language-bash"># Comprehensive smoke test (recommended)
nb smoke_test
</code></pre>
<p>This target performs:
1. <strong>Artifact Validation</strong>: Tests 4+ executables (nb.exe, lf.exe, nBackup.exe, wi.exe)
2. <strong>Build System Validation</strong>: Uses <code>Test-TargetDelegation</code> function to verify MSBuild target relationships
3. <strong>Consolidated Results</strong>: Single pass/fail result for all validation checks</p>
<p><strong>Migration Note</strong>: The deprecated <code>TEST_TARGET_DELEGATION</code> target functionality is now integrated into <code>SMOKE_TEST</code>.</p>
<h3 id="github-actions-integration">GitHub Actions Integration</h3>
<pre><code class="language-yaml">- name: Install ntools using ntools-scripts module
  run: |
    Import-Module &quot;./scripts/module-package/ntools-scripts.psm1&quot; -Force
    Install-NTools -NtoolsJsonPath &quot;./dev-setup/ntools.json&quot;
</code></pre>
<h2 id="key-improvements">Key Improvements</h2>
<h3 id="1-deterministic-repository-path-detection">1. Deterministic Repository Path Detection</h3>
<p>The <code>Publish-AllProjects</code> function now requires an explicit <code>RepositoryRoot</code> parameter, eliminating unreliable heuristic detection:</p>
<pre><code class="language-powershell"># Before (unreliable)
Publish-AllProjects -OutputDir $output -Version $version

# After (deterministic)
Publish-AllProjects -OutputDir $output -Version $version -RepositoryRoot $repoRoot
</code></pre>
<h3 id="2-configurable-ntoolsjson-path">2. Configurable ntools.json Path</h3>
<p>The <code>Install-NTools</code> function accepts a custom path to ntools.json:</p>
<pre><code class="language-powershell"># Use specific configuration file
Install-NTools -NtoolsJsonPath &quot;./dev-setup/ntools.json&quot;
</code></pre>
<h3 id="3-unified-error-handling">3. Unified Error Handling</h3>
<p>All functions use consistent error handling and logging:</p>
<pre><code class="language-powershell">Write-Info &quot;Starting operation...&quot;
Write-Success &quot;Operation completed successfully&quot;
Write-Warning &quot;Potential issue detected&quot;
Write-Error &quot;Operation failed&quot;
</code></pre>
<h3 id="4-backward-compatibility">4. Backward Compatibility</h3>
<ul>
<li>Legacy script entry points in <code>scripts/setup/</code> still work</li>
<li>Module functions can be called directly</li>
<li>All original functionality preserved</li>
</ul>
<h2 id="migration-from-legacy-scripts">Migration from Legacy Scripts</h2>
<h3 id="for-developers">For Developers</h3>
<pre><code class="language-powershell"># Old way
./scripts/build/build-verify-artifacts.ps1  # deprecated - use Invoke-VerifyArtifacts

# New way (module-based)
Import-Module &quot;./scripts/module-package/ntools-scripts.psm1&quot; -Force
Invoke-VerifyArtifacts -ArtifactsPath &quot;C:\Artifacts\MySolution\Release\1.2.3&quot; -ProductVersion &quot;1.2.3&quot;
</code></pre>
<h3 id="for-cicd">For CI/CD</h3>
<pre><code class="language-yaml">run: |
  Import-Module &quot;./scripts/module-package/ntools-scripts.psm1&quot; -Force
  Install-NTools -NtoolsJsonPath &quot;./dev-setup/ntools.json&quot;
</code></pre>
<h3 id="for-msbuild">For MSBuild</h3>
<pre><code class="language-xml">&lt;!-- Old way --&gt;
&lt;Exec Command='pwsh -File &quot;$(SolutionDir)\scripts\build\publish-all-projects.ps1&quot;' /&gt;

&lt;!-- New way (automatically used) --&gt;
&lt;Exec Command='pwsh -Command &quot;Import-Module ntools-scripts; Publish-AllProjects -RepositoryRoot $(SolutionDir)&quot;' /&gt;
</code></pre>
<h2 id="module-development">Module Development</h2>
<h3 id="adding-new-functions">Adding New Functions</h3>
<ol>
<li>Add function to appropriate section in <code>ntools-scripts.psm1</code></li>
<li>Add function name to <code>Export-ModuleMember</code> line</li>
<li>Update <code>FunctionsToExport</code> in <code>ntools-scripts.psd1</code></li>
<li>Increment module version</li>
<li>Update documentation</li>
</ol>
<h3 id="testing">Testing</h3>
<pre><code class="language-powershell"># Test the module
Import-Module &quot;./scripts/module-package/ntools-scripts.psm1&quot; -Force
Test-NToolsScriptsModule
</code></pre>
<h3 id="installation">Installation</h3>
<pre><code class="language-powershell"># Install module manually for development
Install-NToolsScriptsModule -InstallPath &quot;$env:ProgramFiles\WindowsPowerShell\Modules\ntools-scripts&quot; -Force
</code></pre>
<h2 id="best-practices">Best Practices</h2>
<ol>
<li><strong>Always specify -Force when importing</strong> to reload changes during development</li>
<li><strong>Use explicit parameters</strong> like <code>-RepositoryRoot</code> for deterministic behavior</li>
<li><strong>Import the module</strong> before calling any functions</li>
<li><strong>Check module version</strong> with <code>Get-NtoolsScriptsVersion</code> for troubleshooting</li>
<li><strong>Use the utility functions</strong> like <code>Write-Info</code>, <code>Write-Success</code> for consistent output</li>
</ol>
<h2 id="troubleshooting">Troubleshooting</h2>
<h3 id="module-not-found">Module Not Found</h3>
<pre><code class="language-powershell"># Verify module location
Test-Path &quot;./scripts/module-package/ntools-scripts.psm1&quot;

# Check if installed
Test-Path &quot;$env:ProgramFiles\nbuild\modules\ntools-scripts\ntools-scripts.psm1&quot;
</code></pre>
<h3 id="version-issues">Version Issues</h3>
<pre><code class="language-powershell"># Check module version
Get-NtoolsScriptsVersion

# Check installed version vs source
Import-Module &quot;./scripts/module-package/ntools-scripts.psm1&quot; -Force
Get-NtoolsScriptsVersion
</code></pre>
<h3 id="function-not-available">Function Not Available</h3>
<pre><code class="language-powershell"># List all available functions
Get-Command -Module ntools-scripts

# Check if module is properly imported
Get-Module ntools-scripts
</code></pre>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../ntools/" class="btn btn-neutral float-left" title="Development Tools"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../ntools-scripts-module-api/" class="btn btn-neutral float-right" title="API">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/naz-hage/ntools" class="fa fa-code-fork" style="color: #fcfcfc"> ntools</a>
        </span>
    
    
      <span><a href="../ntools/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../ntools-scripts-module-api/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
