
# nbuild.exe
- nbuild.exe generates `common.targets` and `nbuild.bat` to the solution folder.
- Expects `nbuild.targets` file in the solution folder.
- Usage:
    nbuild.exe [-cmd value] [-git value] [-project value] [-org value] [-url value] [-branch value] [-tag value] [-buildtype value] [-v value]
  - cmd       : command. value = [targets]
         targets         -> list targets in nbuild.targets and common.targets files (string, default=)
  - git       : git Command, value= [gettag | settag| autotag| autoversion| deletetag | getbranch | setbranch| createbranch]
         gettag          -> Get tag of a branch for a given project
         settag          -> Set specied tag of a branch for a given project
         autotag                 -> Set next tag based of branch and project on STAGING vs.PRODUCTION build (commit to remote repo)
         autoversion     -> Equivalent to `autotag` cmd (Does not commit to remote repo)
         deletetag       -> Delete specified tag of a branch for a given Project
         getbranch       -> Get the current branch for a given project
         setbranch       -> Set/checkout specified branch for a given project
         createbranch    -> Create specified branch for a given project
         clone           -> Clone a Project (string, default=)
  - project   : Project Name (string, default=)
  - org       : Organization Name (string, default=)
  - url       : GitHub Url Name (string, default=)
  - branch    : Branch Name (string, default=)
  - tag       : Tag Name (string, default=)
  - buildtype : Values: STAGING | PRODUCTION (string, default=)
  - v         : verbose. value = [true | false] (true or false, default=False)

# nbuild.targets
- nbuild.targets is a MSBuild file that is imports `common.targets`.
- The following properties are required in nbuild.targets:
    - SolutionName: The name of the solution file.
    	```xml
        <PropertyGroup>
    		<!--The GUID should be replaced with the solution name-->
        	<SolutionName>{A1B2C3D4-E5F6-G7H8-I9J0-K1L2M3N4O5P6}</SolutionName>
    	    </PropertyGroup>
        ```

- The following target is required in nbuild.targets:
    - ARTIFACTS: The folder where the artifacts are copied to.
        ```xml
        <Target Name="ARTIFACTS">
        <!--The folder where the artifacts are copied to-->
        <ItemGroup>
            <BinaryFiles Include="$(Solut
        ```
                    
    | Target Name | Description |
    | --- | --- |
    |ARTIFACTS| List of binary, test, and data files to be deployed|

# common.targets
- common.targets is a MSBuild file that is generated by nbuild.exe.
- common.targets is imported by nbuild.targets.

- TARGETS:

    | Target Name | Description | Depends On |
    | --- | --- |--- |
    |PROPERTIES| Global Properties that can be overriden| Global properties used by all Targets|
    |CLEAN| Performs clean up by deleting all generated artifacts| |
    |STAGING| Builds a staging product for testing prior to  production| |
    |STAGING_DEPLOY| Builds a staging product  and deploy| |
    |PRODUCTION| Builds a production product to be consumer by users| |
    |PRODUCTION_DEPLOY| Builds a production product and deploy| |
    |SETUP_STAGING| Sets up the build type as `STAGING`.  Utilized by other targets| |
    |SETUP_PRODUCTION| Sets up the build type as `PRODUCTION`.  Utilized by other targets| |
    |SIGN_PRODUCT| Digitally sign any binaries.  To be overriden in nbuild.targets| |
    |GIT_TAG| Tags the build with the current version| |
    |AUTOTAG| Updates the VERSION of the build based on the build type: Staging or Production| |
    |GIT_PUSH| Push changes to Git remote repo | |
    |SOLUTION| Build the solution using `dotnet build`.  This is the default | |
    |SOLUTION_MSBUILD| Build the solution using `MSBuild` command. | |
    |PACKAGE| Packages the project.  The Default is to zip all artifacts into a single VERSION.zip  To be overriden in nbuild.targets| ARTIFACTS|
    |SAVE_ARTIFACTS| Deploys the solution to Target folder.  The target `ARTIFACTS` is |ARTIFACTS |
    |DEPLOY| Deploys the solution to Deployment folder.  The target `ARTIFACTS` tis required in `nbuilds.targets`| |
    |TEST| Build and run the tests with the `Debug` configuration, this is the default| |
    |TEST_RELEASE| Build and run the tests with the `Release` configuration| |


| Target Name | Description |
| --- | --- |
| PROPERTIES | Sets up properties for the build process, reads the version from a file, checks if essential properties are defined, and prints out some properties and git information. |
| CLEAN | Cleans the solution by removing the output directories and deleting the obj directories. |
| STAGING | Executes a series of targets for staging: CLEAN, SETUP_STAGING, AUTOTAG, SOLUTION, TEST, SAVE_ARTIFACTS, GIT_PUSH, PACKAGE. |
| STAGING_DEPLOY | Executes the STAGING target and then the DEPLOY target. |
| PRODUCTION | Executes a series of targets for production: CLEAN, SETUP_PRODUCTION, AUTOTAG, SOLUTION, TEST, GIT_TAG, SAVE_ARTIFACTS, GIT_PUSH, PACKAGE. |
| PRODUCTION_DEPLOY | Executes the PRODUCTION target and then the DEPLOY target. |
| SETUP_STAGING | Sets the build type to STAGING. |
| SETUP_PRODUCTION | Sets the build type to PRODUCTION and updates the main branch of the git repository. |
| SIGN_PRODUCT | Placeholder target for signing the product. Currently, it does not perform any actions. |
| GIT_TAG | Commits changes to the git repository, pulls the latest changes, pushes the changes, and creates a tag. |
| AUTOTAG | Gets the git branch, reads the build type, and automatically creates a tag based on the branch and build type. |
| GIT_PUSH | Gets the git branch, sets a tag, commits changes to the git repository, creates a tag, pulls the latest changes, and pushes the changes and tags. |
| SOLUTION | Builds the solution using the `dotnet build` command with the specified configuration, version, and culture. |
| SOLUTION_MSBUILD | Restores the solution's dependencies with `dotnet restore` and then builds the solution using MSBuild with the specified configuration, platform, version, and culture. |
| PACKAGE | Creates a zip file of the artifacts folder and then removes the artifacts folder. |
| SAVE_ARTIFACTS | Copies various types of files (binary files, EnUSFiles, ref, RunTimesLib, Default, RunTimesLibNet, RunTimesNetStandard20, RunTimesNative) to the artifacts folder. |
| Deploy | Checks if the user is an administrator and if the DeploymentFolder property is defined. If both conditions are met, it extracts the zip file of the artifacts folder to the deployment folder and then removes the setup folder. |
| TEST | Runs tests on the solution with the `dotnet test` command with the specified configuration and logger settings. |
| TEST_RELEASE | Similar to TEST, but uses the release configuration. |
| SingleProject | Demonstrate how to build a single projec. Builds a specific project (`nbuild\nbuild.csproj`) using the `dotnet build` command with the specified configuration, runtime, version. |
| IS_ADMIN | Checks if the user is an administrator by running the `net session` command and sets the `IsAdmin` property based on the exit code. |
| HandleError | Prints a high importance message stating that an error occurred while reading the version file. |

# nbuild.bat
- nbuild.bat is a batch file that is generated by nbuild.exe.
- nbuild.bat is used to run MSBuild to build any target defined in *targets files.